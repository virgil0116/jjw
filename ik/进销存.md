# 进销存

### 数据库配置

**开发环境**  ***/data0/rb/ikjxc-dev.ikcrm.com/shared/config***

```yml
default: &default
  adapter: mysql2
  pool: 5
  username: ikjxc_dev
  password: t$Y8nWxz
  encoding: utf8mb4
  collation: utf8mb4_unicode_ci
  host: rm-m5ef10gzq1n5e7b9a.mysql.rds.aliyuncs.com
  reconnect: true

production:
  <<: *default
  database: ik_invoicing_development

production_extension:
  <<: *default
  database: ik_invoicing_development_extension

user_center:
  <<: *default
  host: rm-m5ef10gzq1n5e7b9a.mysql.rds.aliyuncs.com
  database: user_center_dev
  username: uc_read
  password: '@wikZ4EuIJmY2y7l'
```



**测试环境**  ***/data0/rb/ikjxc-test.ikcrm.com/shared/config***

```yml
default: &default
  adapter: mysql2
  encoding: utf8
  pool: 10
  username: ikjxc_test
  password: '#Jm07GhE'
  encoding: utf8mb4
  collation: utf8mb4_unicode_ci
  host: rdscbq34656z0ix59br0.mysql.rds.aliyuncs.com
  reconnect: true

production:
  <<: *default
  database: ik_invoicing_test

production_extension:
  <<: *default
  database: ik_invoicing_test_extension
```



### ElasticSearch配置

**elasticsearch服务器**  ***app/config/elasticsearch.yml配置***

```yml
defaults: &defaults
  server_url: http://47.105.75.246:9400

development:
  <<: *defaults

production:
  <<: *defaults

# 内网地址 192.168.1.21:40022
# 例如：
```

```ruby
# 本地开发环境，使用线上es服务器，需要在model中配置相应的 index_name
class OrderItem < ApplicationRecord
  searchkick language: 'chinese',
             text_middle: %i[name spec attr_names],
             searchable: %i[name spec attr_names],
             filterable: %i[orderable_type org_id],
             callbacks: false,
             index_name: 'order_items_production'
end
```





### 服务器地址

**进销存dev list**  

```json
{
  "server": "192.168.1.15:40022",
  "server": "172.16.100.102:40022",
  "server": "192.168.100.101:40022",
}
```

**进销存test list**  

```json
{
  "server": "192.168.1.16:40022"
}
```

**进销存服务器登陆**

```shell
$ ssh -p40022 rb@47.104.172.75		# 根服务器（登陆以下服务器需要先登陆该服务器）
$ ssh -p40022 rb@192.168.1.15			# dev服务器
$ ssh -p40022 rb@192.168.1.16			# test服务器
```



### 版本升级

```shell
$ rvm get stable 			# 升级rvm
$ rvm install 2.5.8		# 安装ruby2.5.8
```

